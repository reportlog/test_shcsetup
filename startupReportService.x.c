#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	./shc -e 31/12/2222 -r -f startupReportService 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\237"
#define      date_z	11
#define      date	((&data[3]))
	"\022\117\000\210\264\343\120\157\041\344\030\146\205\155"
#define      text_z	1041
#define      text	((&data[265]))
	"\264\167\134\160\156\355\375\263\306\040\152\327\344\241\264\275"
	"\327\150\123\212\063\142\274\374\365\316\114\142\243\101\003\130"
	"\270\140\310\047\115\306\332\024\346\105\354\313\346\240\210\276"
	"\011\333\111\075\076\005\072\063\323\206\225\167\307\231\320\200"
	"\371\230\247\107\137\202\133\105\307\110\020\256\351\231\154\362"
	"\165\265\060\263\272\152\346\216\361\174\006\270\026\326\071\017"
	"\157\341\126\316\143\262\024\053\372\045\331\344\277\105\327\064"
	"\373\007\350\265\162\317\104\143\114\112\034\142\041\126\162\220"
	"\067\311\137\233\173\163\306\166\230\237\132\127\345\061\214\340"
	"\071\165\226\254\104\332\017\221\045\054\363\106\202\145\327\271"
	"\056\066\125\252\252\033\041\103\273\174\233\240\256\047\201\350"
	"\234\027\224\341\362\243\162\027\320\146\136\122\314\065\014\373"
	"\154\141\245\027\175\307\132\070\103\365\331\361\035\132\331\271"
	"\162\156\233\144\022\016\173\342\165\331\064\101\017\101\074\174"
	"\242\342\223\040\251\355\131\354\342\062\336\377\215\270\271\377"
	"\046\125\144\070\143\337\032\330\271\117\144\172\014\206\333\061"
	"\177\304\272\362\122\356\360\272\045\111\052\320\057\364\311\037"
	"\162\320\272\377\062\231\273\172\104\344\175\326\314\102\312\271"
	"\124\037\113\114\137\274\364\103\276\321\001\133\235\071\142\227"
	"\144\052\212\361\074\111\300\265\354\306\304\217\244\240\367\325"
	"\010\300\217\306\057\043\330\224\356\207\062\221\117\321\361\271"
	"\150\320\032\115\106\104\210\153\006\223\335\060\064\272\306\105"
	"\302\150\357\152\225\120\052\051\046\257\045\265\157\000\171\307"
	"\223\044\211\230\175\133\100\364\032\251\156\207\126\256\233\172"
	"\344\014\251\133\150\052\165\151\011\076\114\241\110\113\106\271"
	"\070\053\210\102\067\101\332\163\233\256\271\067\005\247\122\165"
	"\271\364\146\136\243\153\304\217\043\103\362\103\327\322\134\053"
	"\167\356\337\077\014\230\173\024\214\220\306\044\304\047\064\177"
	"\146\324\364\111\233\210\204\154\307\351\052\014\242\043\171\225"
	"\000\154\121\304\213\303\150\062\336\164\351\377\071\012\062\176"
	"\113\077\314\167\062\101\136\062\355\041\342\134\225\103\205\154"
	"\202\241\162\023\166\123\126\317\276\152\272\266\313\146\031\104"
	"\024\065\177\321\111\103\234\064\324\127\262\054\052\214\161\151"
	"\024\117\215\242\026\225\070\073\372\026\203\252\155\206\331\373"
	"\323\100\362\253\150\017\000\167\267\073\057\044\011\221\251\254"
	"\040\244\127\240\133\203\144\312\007\361\230\132\177\174\027\000"
	"\346\030\115\353\204\163\203\136\360\105\036\212\347\225\117\361"
	"\011\022\001\336\057\056\356\177\165\140\154\334\377\266\210\363"
	"\140\325\352\262\031\242\303\336\236\037\023\046\204\055\145\040"
	"\234\136\025\226\134\105\110\313\170\234\033\251\350\232\321\000"
	"\157\025\012\345\130\342\150\007\206\355\307\267\361\342\014\214"
	"\376\313\015\250\165\270\304\011\140\114\347\001\316\061\165\322"
	"\241\051\152\104\005\026\300\231\045\042\202\000\257\020\105\235"
	"\021\073\267\147\143\376\101\205\307\044\250\075\222\077\220\125"
	"\035\237\076\070\301\235\064\225\054\143\274\103\163\273\343\233"
	"\334\062\010\225\055\312\112\074\355\116\066\164\151\236\050\360"
	"\345\224\303\067\116\335\155\032\055\020\271\304\255\243\202\004"
	"\323\240\072\024\230\201\132\313\363\325\037\212\104\134\327\127"
	"\207\125\026\210\263\077\273\251\013\234\135\306\346\225\311\266"
	"\120\252\360\301\142\371\121\306\344\003\017\352\004\227\022\127"
	"\271\232\016\035\223\344\352\155\345\120\015\055\057\147\116\266"
	"\170\003\266\122\167\212\260\072\216\251\337\266\330\040\156\110"
	"\041\021\214\063\257\247\321\322\175\131\116\102\006\345\304\237"
	"\364\050\330\131\033\057\371\222\157\214\244\002\037\272\065\074"
	"\147\213\377\004\154\157\056\350\321\375\276\151\277\052\224\210"
	"\040\245\350\033\024\127\220\066\304\017\306\307\360\234\220\120"
	"\007\015\137\117\370\075\333\223\130\161\117\302\027\126\344\115"
	"\060\035\264\210\215\032\241\355\007\135\267\146\017\122\007\166"
	"\131\360\204\164\137\017\364\301\221\374\176\275\237\176\135\051"
	"\356\150\350\252\267\235\305\363\135\052\156\221\325\123\141\161"
	"\114\116\216\064\051\002\304\003\325\165\371\046\357\343\136\276"
	"\114\243\010\152\030\052\207\206\136\017\134\175\142\270\215\122"
	"\270\137\321\206\020\126\043\343\351\062\120\162\034\033\072\065"
	"\047\176\135\105\374\165\337\300\172\034\001\010\156\355\223\223"
	"\010\202\073\154\170\210\270\117\165\216\376\043\160\350\006\075"
	"\206\253\012\061\011\310\133\132\163\104\005\036\114\263\045\021"
	"\213\024\077\030\010\150\127\260\200\270\137\263\056\165\154\235"
	"\171\335\116\245\050\214\270\250\335\144\054\125\271\164\036\242"
	"\316\033\275\002\076\035\024\031\256\304\144\167\126\117\271\264"
	"\057\074\014\012\017\077\110\360\313\044\261\216\100\202\115\341"
	"\225\021\171\165\120\164\165\053\200\204\010\066\054\153\377\253"
	"\320\244\352\042\321\220\034\354\131\066\146\057\215\116\147\147"
	"\046\244\315\237\062\304\047\167\177\221\336\064\375\171\024\356"
	"\031\363\221\305\162\133\235\161\070\306\030\356\024\157\074\274"
	"\355\167\360\276\050\033\116\127\016\262\320\254\217\141\032\266"
	"\371\115\300\236\037\242\306\306\136\107\316\351\053\066\054\357"
	"\225\215\006\152\311\321\061\323\317\335\165\361\356\123\052\305"
	"\011\124\017\035\045\034\055\371\036\211\224\246\214\157\216\337"
	"\026\032\227\115\220\042\373\007\171\126\363\177\332\260\371\034"
	"\017\327\346\104\064\062\023\036\112\261\231\247\316\175\136\006"
	"\310\045\120\113\163\304\325\043\043\012\015\032\311\220\126\105"
	"\063\070\330\123\341\305\254\316\250\337\254\247\155\144\141\154"
	"\212\266\321\303\032\261\335\363\152\054\015\063\274\143\171\360"
	"\234\121\103\176\026\360\114\277\317\370\147\074\135\310\251\350"
	"\177\172\253\231\053\210\214\226\265\231\312\162\375\103\142\232"
	"\224\246\030\253\226\144\153\145\135\322\242\272\232\113\243\031"
	"\306\116\263\362\327\077\211\215\331\123\377\327\227\142\161\054"
	"\010\211\330\237\356\103\005\113\025\247\006\257\363\251\311\272"
	"\367\174\254\316\273\065\134\225\211\133\154\040\276\336\115\306"
	"\147\045\146\125\150\153\241\175\022\247\054\006\120\365\300\107"
	"\162\154\026\055\242\162\303\054\316\057\115\214\016\232\123"
#define      lsto_z	1
#define      lsto	((&data[1470]))
	"\126"
#define      opts_z	1
#define      opts	((&data[1471]))
	"\352"
#define      tst1_z	22
#define      tst1	((&data[1475]))
	"\023\321\075\166\200\225\124\151\003\227\020\003\011\371\264\202"
	"\242\340\165\361\242\314\004\007\236\143"
#define      tst2_z	19
#define      tst2	((&data[1502]))
	"\071\152\302\147\256\214\176\111\175\367\021\166\375\375\372\110"
	"\231\054\304\000\206\255\003\015\065\052"
#define      shll_z	8
#define      shll	((&data[1524]))
	"\320\136\317\356\002\213\057\107\207"
#define      chk1_z	22
#define      chk1	((&data[1535]))
	"\343\336\111\150\001\132\135\321\305\171\252\122\344\367\020\021"
	"\133\323\023\125\022\000\204\223"
#define      chk2_z	19
#define      chk2	((&data[1560]))
	"\010\301\026\355\105\035\317\356\142\241\317\237\352\323\214\253"
	"\343\137\000\327\325\376\255\371\052"
#define      msg2_z	19
#define      msg2	((&data[1583]))
	"\106\166\206\163\046\226\065\044\374\346\236\056\121\015\172\027"
	"\242\370\331\126\063\072"
#define      pswd_z	256
#define      pswd	((&data[1644]))
	"\347\253\061\022\345\065\155\155\305\325\216\251\264\160\106\136"
	"\170\010\165\046\001\240\245\067\057\353\153\151\153\012\146\123"
	"\265\227\145\233\315\322\010\222\222\372\020\316\212\247\356\252"
	"\024\061\022\133\002\132\137\222\212\066\222\035\345\044\166\123"
	"\204\316\000\342\367\044\321\212\037\342\130\251\211\107\124\236"
	"\170\146\371\173\301\131\016\113\217\240\150\164\305\337\310\111"
	"\256\311\053\246\355\375\060\014\337\211\266\151\320\012\007\111"
	"\161\000\304\062\132\323\175\351\163\346\136\070\306\046\202\164"
	"\357\255\032\335\253\113\352\213\325\240\364\245\252\373\357\034"
	"\374\263\116\126\207\314\100\372\263\237\062\171\305\264\356\265"
	"\142\011\223\016\125\175\231\052\036\215\317\311\211\276\345\206"
	"\162\064\335\371\001\035\364\264\274\047\056\202\334\034\070\077"
	"\046\313\115\173\111\346\245\150\164\165\061\375\064\027\203\247"
	"\114\140\241\115\176\225\001\073\275\057\276\231\114\366\330\163"
	"\302\045\356\014\014\224\164\200\012\246\175\077\275\001\347\011"
	"\142\210\127\341\036\130\035\334\210\333\165\325\322\115\110\224"
	"\163\067\241\177\314\025\377\327\273\174\026\171\176\375\203\341"
	"\206\332\302\245\063\337\201\273\273\367\220\215\104\331\042\267"
	"\020\303\066\335\331\066\264\225\250\227\073\134\007\201\273\200"
	"\212\061\247\213\321\114\303\001\070\056\152\244\070\320\367\356"
	"\150\135\212\065\057\222\310\330\052\003\065\062\205\360\262\017"
	"\042\131\232\364\246\135\365\337\214\137\203\305\060\173\264\230"
	"\330\076\316\010\321\226\340\374"
#define      msg1_z	42
#define      msg1	((&data[1964]))
	"\216\165\020\343\034\343\141\361\123\327\141\057\252\330\220\320"
	"\103\327\173\020\171\250\113\130\010\320\256\327\055\326\363\063"
	"\202\066\042\200\370\301\027\337\111\000\037"
#define      inlo_z	3
#define      inlo	((&data[2007]))
	"\045\226\002"
#define      xecc_z	15
#define      xecc	((&data[2010]))
	"\246\042\160\054\244\146\021\273\263\125\011\311\126\051\255\034"
	"\341\047"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
