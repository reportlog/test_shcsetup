#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	./shc -f logCapturex 
#endif

static  char data [] = 
#define      chk1_z	22
#define      chk1	((&data[4]))
	"\274\123\047\130\271\222\251\143\124\061\006\077\315\225\076\027"
	"\332\370\262\215\205\064\203\366\140\110\126\203\135\224\246"
#define      opts_z	1
#define      opts	((&data[31]))
	"\151"
#define      text_z	2304
#define      text	((&data[384]))
	"\265\113\220\230\264\254\344\270\022\202\353\217\110\172\136\101"
	"\066\261\151\216\010\354\353\235\222\265\121\161\221\355\354\107"
	"\071\175\337\355\051\304\245\074\106\221\313\217\013\051\321\101"
	"\333\072\320\343\046\273\200\271\161\322\052\003\277\027\112\371"
	"\225\051\346\277\356\214\373\064\035\306\304\050\360\226\152\313"
	"\320\072\256\367\366\057\261\147\002\334\153\302\363\265\273\211"
	"\336\241\110\315\055\103\001\113\012\306\163\372\134\336\305\055"
	"\030\164\044\016\244\325\166\246\261\341\150\245\227\043\057\166"
	"\305\167\103\363\273\104\076\305\013\262\277\147\220\205\224\250"
	"\371\271\267\236\217\055\104\101\017\255\347\246\320\026\034\226"
	"\216\137\211\111\244\310\016\260\172\316\027\012\123\254\262\115"
	"\146\151\354\365\227\061\067\247\336\036\116\257\064\152\105\302"
	"\312\317\014\157\227\032\037\021\351\067\033\075\344\316\213\113"
	"\070\167\100\317\250\170\167\206\226\305\066\313\060\173\216\373"
	"\112\232\152\341\265\212\363\236\302\016\334\247\334\147\362\024"
	"\336\062\344\207\253\133\016\101\041\104\014\121\300\233\114\012"
	"\065\267\354\352\102\337\211\005\356\145\254\312\314\236\337\253"
	"\321\304\063\174\040\101\275\101\206\312\223\106\145\340\120\233"
	"\230\075\206\332\035\017\337\013\164\214\326\101\052\266\355\373"
	"\172\040\167\232\142\065\334\350\000\157\056\146\120\177\001\350"
	"\275\207\303\332\227\242\345\014\056\274\115\131\162\073\124\354"
	"\133\314\207\276\002\143\246\003\323\325\151\043\125\152\013\022"
	"\121\162\253\311\022\062\137\022\015\154\157\002\105\024\146\043"
	"\345\203\225\337\360\161\170\026\162\354\105\361\376\073\054\144"
	"\126\167\154\246\146\030\341\156\213\024\327\170\130\157\064\101"
	"\363\361\363\360\237\232\353\016\204\002\211\043\057\064\244\025"
	"\374\113\360\321\032\005\224\226\125\236\034\223\005\211\236\234"
	"\105\364\031\253\161\226\044\370\317\206\143\116\275\352\054\303"
	"\257\311\335\274\001\141\156\341\157\233\352\161\132\063\315\376"
	"\146\152\212\316\347\156\177\360\026\065\170\331\153\137\154\257"
	"\325\170\240\323\014\305\235\025\032\277\144\334\260\131\331\330"
	"\047\117\241\326\110\360\013\240\305\334\121\125\345\146\302\074"
	"\316\151\052\133\323\170\133\177\014\266\102\021\161\220\121\074"
	"\031\137\006\117\243\166\200\137\224\277\121\354\004\040\027\265"
	"\165\272\027\331\342\040\141\276\152\271\243\364\363\174\102\070"
	"\363\305\244\031\041\025\233\243\022\271\321\121\235\207\103\050"
	"\311\065\251\030\362\131\076\063\004\335\317\200\156\047\024\221"
	"\314\333\041\310\241\106\222\150\130\147\171\077\361\166\317\062"
	"\202\023\053\076\343\132\112\050\227\177\265\146\015\153\157\101"
	"\346\254\357\045\351\366\271\234\027\235\003\160\323\164\233\257"
	"\175\073\314\220\274\232\033\110\237\010\267\172\316\300\306\101"
	"\350\216\152\161\031\133\363\107\104\113\220\336\101\110\222\002"
	"\330\314\042\202\170\342\064\173\330\060\065\142\364\156\351\006"
	"\147\365\105\241\200\210\302\333\304\274\374\332\300\172\047\263"
	"\117\376\254\215\270\102\157\310\243\054\307\244\064\106\242\206"
	"\111\112\214\163\241\157\043\164\207\051\154\251\273\234\356\370"
	"\356\004\334\160\123\034\363\322\026\207\042\010\327\004\360\316"
	"\140\002\073\317\071\145\375\256\225\153\355\060\127\337\103\042"
	"\363\133\036\131\212\242\037\117\047\267\332\330\065\317\023\364"
	"\262\365\177\064\226\016\053\302\315\242\362\200\072\203\037\150"
	"\152\060\333\013\213\034\346\320\321\264\157\044\012\055\346\031"
	"\274\241\072\304\216\121\010\250\070\356\134\364\041\006\333\153"
	"\175\177\323\022\161\246\253\202\262\007\065\267\062\346\065\376"
	"\060\170\231\354\067\111\020\025\100\302\131\112\372\307\310\061"
	"\130\115\051\223\262\224\302\124\002\110\325\165\122\110\077\135"
	"\275\344\215\363\226\141\302\103\352\037\344\254\050\302\357\264"
	"\166\265\360\251\011\061\065\142\125\365\004\373\361\233\333\245"
	"\102\065\375\263\012\025\313\273\131\232\141\275\355\215\271\236"
	"\353\025\005\010\257\202\110\334\001\241\272\251\053\111\017\003"
	"\344\153\121\056\212\042\054\212\344\162\007\062\004\275\014\127"
	"\305\013\256\352\241\002\172\255\357\211\061\355\020\277\347\015"
	"\250\047\077\030\323\045\217\237\071\100\365\133\062\337\202\042"
	"\322\055\245\340\226\102\016\146\347\243\076\371\221\352\033\310"
	"\004\311\024\242\031\233\212\050\032\213\254\341\365\115\200\225"
	"\301\142\337\021\360\245\144\154\354\255\377\040\123\261\223\157"
	"\314\156\302\163\353\264\374\250\373\274\216\274\022\265\300\200"
	"\375\316\317\173\175\076\271\043\316\205\075\312\371\155\172\105"
	"\103\226\012\200\036\302\204\221\260\221\343\174\051\250\040\055"
	"\127\015\310\036\366\001\070\314\336\215\112\142\370\302\315\145"
	"\307\363\067\303\214\274\370\307\136\035\002\322\351\337\171\205"
	"\263\170\021\017\056\212\222\134\100\052\217\210\260\152\322\360"
	"\122\274\264\247\105\120\214\175\356\001\072\244\147\171\217\020"
	"\107\133\302\135\217\276\273\345\346\262\376\322\332\153\144\066"
	"\326\130\233\333\011\076\257\125\264\043\126\207\327\166\030\217"
	"\344\157\120\062\325\111\000\152\101\002\172\030\011\212\350\366"
	"\231\102\121\210\010\007\164\336\334\046\362\146\256\214\164\173"
	"\171\256\147\276\376\332\111\167\171\047\267\032\241\240\000\102"
	"\310\253\143\260\333\345\331\116\066\262\022\012\024\037\032\111"
	"\005\347\310\240\102\134\052\247\057\315\135\220\011\204\335\265"
	"\275\307\033\172\234\325\101\203\267\022\206\131\347\357\374\342"
	"\030\335\307\205\272\152\324\276\161\134\336\314\336\145\173\100"
	"\252\361\300\003\236\366\023\204\174\276\171\377\163\052\346\344"
	"\312\227\273\135\022\211\350\374\172\071\204\332\106\042\127\146"
	"\114\255\172\376\060\101\105\132\345\040\002\227\034\375\271\036"
	"\210\134\001\054\073\111\012\341\151\340\106\042\162\046\263\256"
	"\100\171\146\367\337\031\244\331\265\031\260\212\345\355\264\247"
	"\024\212\335\371\252\306\041\224\210\203\240\014\266\373\370\213"
	"\375\245\360\305\251\023\233\015\052\076\066\163\327\175\256\075"
	"\207\075\125\370\357\320\343\374\127\023\050\056\330\116\007\300"
	"\174\266\172\326\311\312\374\062\127\036\310\203\217\313\373\002"
	"\231\271\327\122\312\270\075\074\013\340\162\037\227\070\210\230"
	"\246\173\172\216\110\261\262\070\350\227\360\231\015\214\014\227"
	"\331\126\163\127\165\107\231\376\272\306\337\212\005\241\147\035"
	"\241\016\153\025\264\144\354\330\104\355\207\156\147\152\177\065"
	"\017\035\341\372\053\213\274\252\033\002\056\004\021\157\155\243"
	"\347\375\251\300\026\056\131\006\300\127\010\345\212\167\105\304"
	"\176\104\163\343\332\163\042\066\347\146\044\326\207\050\112\213"
	"\315\145\012\123\365\312\262\303\265\351\104\234\334\017\261\155"
	"\136\201\056\304\027\074\321\264\111\070\373\232\270\152\037\323"
	"\174\330\341\021\036\326\244\053\231\237\370\227\346\071\023\026"
	"\361\122\017\000\016\076\003\313\214\305\142\344\136\046\320\174"
	"\107\265\005\103\077\171\011\150\135\132\041\366\060\070\256\141"
	"\044\232\227\375\374\364\130\300\240\370\251\043\010\202\105\237"
	"\107\310\304\212\357\334\145\344\233\171\252\070\324\237\213\004"
	"\203\161\356\234\030\220\126\063\311\122\224\076\066\021\315\055"
	"\214\005\025\125\376\135\214\152\351\152\007\077\161\145\045\257"
	"\307\045\023\226\250\136\337\065\346\133\213\103\351\127\167\357"
	"\352\175\155\176\307\153\337\030\014\320\346\132\130\360\132\132"
	"\334\203\201\257\104\253\077\214\373\227\237\312\373\312\323\167"
	"\221\370\313\236\331\212\016\147\211\226\057\037\374\151\245\277"
	"\016\357\176\120\203\220\251\344\230\326\157\104\140\004\173\353"
	"\066\370\145\117\377\214\271\132\340\062\311\025\244\352\273\263"
	"\115\243\364\260\016\171\201\253\340\125\332\124\142\024\067\060"
	"\254\055\142\024\327\355\355\351\262\357\013\371\155\376\233\325"
	"\333\375\247\315\126\151\175\146\342\125\243\061\327\105\340\232"
	"\201\126\240\366\342\157\246\251\340\105\077\040\237\055\047\151"
	"\042\043\372\177\047\161\070\145\144\126\167\032\357\047\262\151"
	"\021\140\300\362\345\014\361\350\375\154\070\336\241\302\037\246"
	"\044\007\210\145\142\376\142\272\110\072\260\216\046\074\247\016"
	"\233\074\130\107\052\037\274\167\056\041\017\227\314\122\214\000"
	"\020\352\127\125\343\327\167\041\366\174\321\325\203\076\164\324"
	"\342\316\056\337\307\141\307\364\344\007\327\237\022\047\027\337"
	"\047\066\307\132\025\175\251\147\103\044\262\330\057\024\240\154"
	"\155\004\035\124\122\266\357\016\212\065\031\225\024\046\052\307"
	"\013\301\065\170\372\046\351\172\171\060\354\210\035\143\221\254"
	"\051\343\032\160\065\004\016\233\271\034\010\052\062\301\032\315"
	"\344\075\055\205\134\242\370\061\107\317\246\164\231\210\110\062"
	"\000\060\236\270\266\153\020\273\332\122\160\230\146\004\264\014"
	"\156\113\232\024\346\163\367\060\377\351\317\017\174\216\340\375"
	"\265\131\305\227\332\322\242\143\022\011\152\145\221\133\146\221"
	"\104\022\324\330\220\106\323\371\020\147\116\113\205\321\202\101"
	"\110\156\065\135\165\036\252\360\057\312\352\211\342\136\063\251"
	"\360\305\316\074\211\222\207\124\375\151\220\064\014\342\257\164"
	"\156\373\147\041\323\105\346\324\213\121\100\306\163\350\335\215"
	"\273\320\332\160\107\212\150\000\350\071\014\115\133\326\063\106"
	"\131\206\025\365\177\243\046\022\251\040\267\134\311\122\072\366"
	"\176\157\070\151\201\225\356\213\214\327\200\033\104\034\330\101"
	"\111\032\373\265\060\047\125\036\226\132\120\033\241\056\320\174"
	"\200\003\042\031\253\372\104\202\157\167\120\266\176\177\216\137"
	"\202\027\150\071\111\254\072\367\212\234\277\212\017\205\027\375"
	"\247\072\244\307\216\323\263\124\036\300\343\204\322\055\333\151"
	"\121\330\006\261\135\330\226\246\177\377\037\077\120\115\014\312"
	"\337\046\240\065\170\266\137\227\304\026\226\046\227\076\362\176"
	"\362\205\210\321\070\367\213\363\157\132\113\345\367\325\077\046"
	"\041\142\251\136\024\037\246\227\270\326\376\234\224\064\024\070"
	"\117\037\142\064\170\036\221\236\335\231\371\306\142\363\176\143"
	"\225\106\140\320\145\103\157\034\137\375\177\104\175\271\173\325"
	"\126\226\052\003\315\160\344\244\017\242\200\157\303\011\173\147"
	"\364\162\047\151\061\010\237\313\242\023\313\133\341\223\204\030"
	"\007\107\005\202\043\127\023\016\074\206\204\276\270\330\354\043"
	"\063\266\157\114\215\077\176\273\271\304\363\372\317\363\011\205"
	"\205\262\272\023\157\147\057\072\344\117\232\235\040\122\136\230"
	"\054\006\271\217\134\256\334\216\254\037\234\237\027\152\056\043"
	"\050\067\326\073\141\240\101\014\033\006\243\003\143\160\264\200"
	"\224\377\335\272\204\152\322\127\031\040\024\351\050\147\255\225"
	"\252\247\325\253\061\076\102\271\120\333\265\033\241\166\033\343"
	"\261\214\102\014\132\374\102\224\103\167\340\247\114\367\364\137"
	"\211\057\002\012\352\371\154\250\134\240\240\016\141\063\241\356"
	"\273\275\376\054\121\141\116\245\220\045\303\100\044\365\055\042"
	"\106\153\023\016\317\156\312\174\124\011\103\322\047\323\211\051"
	"\221\317\000\134\132\242\253\037\171\172\356\266\265\130\213\311"
	"\136\111\140\255\071\011\221\333\366\103\313\302\170\046\344\154"
	"\232\250\132\012\270\042\141\056\212\033\161\243\356\066\106\121"
	"\313\060\111\375\214\002\242\036\264\310\320\000\175\154\357\246"
	"\276\032\347\025\201\226\075\363\271\000\236\025\140\325\034\132"
	"\141\224\313\370\304\011\161\002\356\030\325\032\053\055\124\154"
	"\362\316\355\211\161\322\225\240\217\343\372\001\036\116\355\172"
	"\033\164\071\036\330\337\041\253\265\212\316\012\365\332\035\350"
	"\250\012\161\032\335\007\273\154\353\265\155\012\004\133\204\040"
	"\320\275\076\250\235\140\123\123\353\042\136\341\374\173\311\245"
	"\206\073\300\143\103\173\320\056\060\075\070\065\230\275\125\150"
	"\173\224\021\031\364\144\154\337\206\313\300\203\106\212\050\315"
	"\306\350\060\011\143\000\067\224\076\157\311\327\055\037\100\250"
	"\263\121\301\247\266\055\207\075\370\110\300\077\322\350\015\230"
	"\321\076\242\065\077\331\312\175\111\223\125\166\263\225\037\146"
	"\346\340\015\235\016\225\332\007\335\232\107\260\203\124\110\125"
	"\222\352\212\321\304\124\117\016\350\244\205\233\071\244\001\040"
	"\204\017\275\223\244\230\232\202\062\342\062\266\066\173\013\311"
	"\145\225\232\052\352\351\070\322\215\276\156\307\142\160\350\347"
	"\200\245\172\045\075\025\247\160\367\331\046\056\124\062\367\272"
	"\307\222\345\262\173\036\204\011\334\363\321\076\143\271\046\343"
	"\137\240\010\235\266\257\015\255\211\064\333\336\146\323\230\056"
	"\145\175\340\341\233\145\352\170\130\274\266\274\165\334\237\324"
	"\175\250\162\063\130\177"
#define      tst2_z	19
#define      tst2	((&data[2970]))
	"\275\277\033\220\020\143\364\337\034\234\073\364\363\172\116\225"
	"\004\022\344\037\055\072\024\130\112\365"
#define      chk2_z	19
#define      chk2	((&data[2992]))
	"\346\153\150\143\116\224\154\050\002\223\117\224\111\014\333\125"
	"\007\032\312\161\220\301\352"
#define      pswd_z	256
#define      pswd	((&data[3046]))
	"\244\362\175\104\307\373\354\071\056\105\271\020\047\156\315\347"
	"\211\135\077\324\122\025\377\051\207\217\352\161\170\147\022\123"
	"\171\317\033\223\353\144\164\057\372\107\361\172\225\007\324\212"
	"\034\064\107\343\062\340\260\073\117\144\106\251\162\316\375\354"
	"\235\030\177\210\175\364\270\167\073\251\362\320\261\306\133\315"
	"\373\242\261\056\203\142\151\323\307\260\174\071\176\171\046\034"
	"\222\245\245\017\232\135\207\325\007\172\246\270\100\002\206\074"
	"\245\070\152\050\233\324\374\142\204\170\234\003\362\302\040\204"
	"\150\305\224\002\043\034\327\052\226\176\343\327\200\152\023\046"
	"\243\176\116\076\123\113\241\330\303\075\333\266\377\374\073\147"
	"\301\317\151\345\354\101\020\202\277\364\131\100\137\155\146\002"
	"\354\265\101\077\000\342\027\304\037\363\172\037\357\266\206\261"
	"\206\360\227\162\061\247\364\361\233\115\062\372\273\230\375\247"
	"\116\077\346\117\041\376\023\101\362\216\140\342\104\347\224\312"
	"\327\053\074\011\322\061\373\156\177\055\151\072\306\146\341\025"
	"\245\310\144\307\307\170\011\271\006\151\233\113\121\057\025\050"
	"\132\122\062\055\204\056\234\003\134\005\075\043\154\037\070\022"
	"\350\234\331\257\024\342\150\033\114\004\146\235\063\174\306\035"
	"\132\220\141\041\213\116\133\272\224\024\312\273\203\227\242\014"
	"\365\341\340\107\367\337\161\176\157\133\360\347\303\002\004\035"
	"\222\146\077\036\265\233\331"
#define      inlo_z	3
#define      inlo	((&data[3342]))
	"\134\303\054"
#define      msg1_z	42
#define      msg1	((&data[3347]))
	"\247\077\031\130\237\273\076\032\163\263\005\320\340\246\236\270"
	"\247\332\025\054\226\226\033\246\275\335\047\230\052\175\126\310"
	"\340\304\012\332\073\217\146\056\125\106\171\277\060\210"
#define      date_z	1
#define      date	((&data[3391]))
	"\273"
#define      shll_z	8
#define      shll	((&data[3394]))
	"\160\105\117\353\027\331\276\150\152\377\357\127"
#define      xecc_z	15
#define      xecc	((&data[3407]))
	"\047\204\303\220\063\023\031\210\242\157\202\037\221\041\134\053"
	"\031\162\146"
#define      msg2_z	19
#define      msg2	((&data[3425]))
	"\174\301\000\205\113\010\177\223\152\223\344\320\237\170\340\027"
	"\353\374\346\100\050"
#define      rlax_z	1
#define      rlax	((&data[3444]))
	"\052"
#define      lsto_z	1
#define      lsto	((&data[3445]))
	"\344"
#define      tst1_z	22
#define      tst1	((&data[3449]))
	"\105\004\166\372\104\141\126\211\076\023\100\160\246\303\051\300"
	"\114\245\307\273\020\330\227\037\110\106\356\165\266\064"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
